---
title: "Control Systems and Feedback"
description: "Master the principles of feedback control that keep robots stable and precise. Learn about PID controllers, motor control, and real-time response systems."
sidebar_position: 2
tags: [control-systems, feedback, pid, motor-control, module-2, lesson-2-2]
---

# Lesson 2.2: Control Systems and Feedback

## Lesson Overview

In the previous lesson, you learned about sensors and actuators. Now, you'll discover the "brain" that connects them: the **control system**. A control system reads sensor data, makes decisions, and commands actuators—all while continuously adjusting based on feedback. Without good control, even the best sensors and actuators produce jerky, inaccurate, or unstable robot behavior.

Think of driving a car: You sense your position on the road (sensors), decide how much to turn the wheel (controller), turn the wheel (actuators), and then sense your new position (feedback). Good control systems do this automatically and very quickly.

---

## Learning Objectives

By the end of this lesson, you will be able to:

- **Explain** the purpose of control systems in robots
- **Describe** open-loop vs. closed-loop control architectures
- **Understand** proportional-integral-derivative (PID) control
- **Apply** PID tuning to optimize robot behavior
- **Analyze** real-world control challenges (lag, noise, saturation)

---

## Core Concepts

### What is a Control System?

A **control system** is a set of equations and logic that processes sensor inputs and produces actuator commands. It's the decision-making layer between perception and action.

#### Two Types of Control

**1. Open-Loop Control**
- The robot executes a command without checking the result
- Example: "Spin the motor for 2 seconds"
- Advantages: Simple, fast, no sensor lag
- Disadvantages: No error correction; if something interferes (like pushing the robot), it won't adjust

**2. Closed-Loop Control** (with feedback)
- The robot checks the result of each command and adjusts
- Example: "Spin the motor until the speed reaches 100 RPM"
- Advantages: Self-correcting, stable, adaptive
- Disadvantages: Requires sensors, slightly more complex

Most modern robots use closed-loop control because it's more reliable.

### The PID Controller

The **PID (Proportional-Integral-Derivative) controller** is the most widely used control law in robotics. It compares the desired state (setpoint) with the actual state (measured by sensors) and computes an error signal.

#### The Three Terms

**Proportional (P)**
- Proportional to the current error
- Helps respond immediately to mistakes
- Formula: `P = Kp × error`
- If error is large, P is large
- Problem: If Kp is too high, the system overshoots and oscillates

**Integral (I)**
- Accumulates errors over time
- Helps eliminate steady-state errors
- Formula: `I = Ki × ∫error dt`
- If the robot is consistently off-target, I grows until the error is corrected
- Problem: Can cause lag and overshoot if Ki is too high

**Derivative (D)**
- Responds to how fast the error is changing
- Helps dampen oscillations
- Formula: `D = Kd × (d(error)/dt)`
- Predicts future error and reduces overshooting
- Problem: Amplifies noise in sensor readings

#### The Complete PID Formula

```
output = Kp × error + Ki × ∫error dt + Kd × (d(error)/dt)
```

The controller continuously calculates this at high frequency (e.g., 100 times per second) and sends the output to the actuator.

### Practical Example: Speed Control

Imagine a robot with a wheel motor. The desired speed is 100 RPM (setpoint), but the actual speed is currently 60 RPM.

- **Error** = 100 - 60 = 40 RPM
- **P term** = Kp × 40 → Increases motor voltage immediately
- **I term** = Ki × (accumulated past errors) → Keeps increasing voltage until speed reaches 100
- **D term** = Kd × (rate of change) → Prevents overshooting to 110+ RPM

### Common Control Challenges

**Lag and Delay**
- Sensors report data with a small delay
- Actuators take time to respond
- If the delay is too large, the controller can't react in time

**Saturation**
- Actuators have limits (motors can only go so fast)
- If the controller commands more than the motor can provide, it "saturates"
- Good controllers account for saturation

**Noise**
- Real sensor data is noisy (not perfectly accurate)
- Noisy sensor readings can cause the D term to oscillate
- Solution: Low-pass filtering (smoothing) of sensor data

**Friction and Nonlinearity**
- Real systems don't behave like simple equations
- Friction at low speeds, motor cogging, mechanical slack
- Controllers must be robust to these imperfections

### Tuning a PID Controller

Setting the right values for Kp, Ki, and Kd is called **tuning**. Poor tuning leads to jerky, slow, or unstable behavior.

**Common Tuning Approach (Ziegler-Nichols Method)**:

1. Set Ki = 0, Kd = 0, Kp = 0
2. Slowly increase Kp until the system oscillates continuously
3. Call this value Ku (ultimate gain) and measure the period Tu
4. Set Kp = 0.6 × Ku, Ki = 1.2 × Ku / Tu, Kd = 0.075 × Ku × Tu
5. Fine-tune from there based on observed behavior

**Tuning Tips**:
- **Too much P**: Overshoot and oscillation
- **Too much I**: Slow response and lag
- **Too much D**: Noise amplification, jerky motion
- **Good balance**: Smooth, fast response with minimal overshoot

---

## Hands-On Section

### Exercise 1: Identify Control Types

For each scenario, determine if open-loop or closed-loop control would be better:

1. **A robot vacuum cleaning your floor**
   - Open-Loop: Run motors at fixed power for fixed time
   - Closed-Loop: Adjust motor power based on where it is and what it detects
   - **Which is better? Why?**

2. **A robot arm placing parts on an assembly line**
   - Open-Loop: Move to pre-programmed positions with fixed timing
   - Closed-Loop: Move to positions while reading joint angles
   - **Which is better? Why?**

3. **A drone hovering in place**
   - Open-Loop: Set motor speeds to average hovering power
   - Closed-Loop: Adjust motor speeds based on altitude and tilt sensors
   - **Which is better? Why?**

### Exercise 2: PID Tuning Simulation

Imagine you're tuning a robot car to maintain a speed of 50 cm/s. The car has:
- A wheel encoder (sensor) reading actual speed
- A motor with speed control (actuator)
- A PID controller

**Scenario A: Kp = 0.5, Ki = 0, Kd = 0**
- Initial speed: 0 cm/s
- After 1 second: The car is at 25 cm/s
- After 2 seconds: The car is at 37.5 cm/s
- After 5 seconds: The car is at 49 cm/s
- **Analysis**: Slow to reach target, but stable. Add I to speed it up.

**Scenario B: Kp = 2, Ki = 0, Kd = 0**
- Initial speed: 0 cm/s
- After 0.5 seconds: The car overshoots to 60 cm/s
- After 1 second: The car oscillates between 60 and 40 cm/s
- **Analysis**: Too much P causes oscillation. Add D to dampen.

**Your Task**: Design Kp, Ki, Kd values that:
- Reach 50 cm/s quickly (within 1-2 seconds)
- Don't overshoot more than 5%
- Stabilize smoothly without oscillation

### Exercise 3: Real-World Control Failure

A robot arm is trying to pick up an egg without crushing it. The gripper has a force sensor that measures grip force. The controller should maintain a grip force of 5 Newtons.

**Problem 1**: The force sensor is noisy, fluctuating between 4.8 and 5.2 N constantly.
- How would a high Kd value make this worse?
- What's a better solution?

**Problem 2**: The egg is slippery. If grip force drops below 4 N, the egg starts to slip.
- Why is the I term important here?
- What would happen if Ki = 0?

---

## Summary

**Control systems are the bridge between sensors and actuators.**

**Key Takeaways**:
- Closed-loop control uses feedback to self-correct
- PID controllers are simple yet powerful and widely used in robotics
- Proportional responds to current error, Integral to accumulated error, Derivative to error rate
- Tuning is critical: too much of any term causes problems
- Real-world systems have delay, saturation, and noise that complicate control

---

## References & Suggested Reading

1. **Control Systems Fundamentals**
   - Franklin, G. F., Powell, J. D., & Emami-Naeini, A. (2014). *Feedback Control of Dynamic Systems* (7th ed.). Pearson.

2. **PID Control in Practice**
   - Astrom, K. J., & Hagglund, T. (2005). *Advanced PID Control*. ISA.

3. **Robotics-Specific Control**
   - Spong, M. W., Hutchinson, S., & Vidyasagar, M. (2020). *Robot Modeling and Control* (2nd ed.). Wiley.

4. **Hands-On Experiment**:
   - Build a PID-controlled robot car using Arduino:
     - Sensor: Wheel encoder to measure speed
     - Actuator: DC motor with PWM speed control
     - Tune Kp, Ki, Kd for smooth, accurate speed control
     - Challenge: Maintain constant speed on uneven surfaces

---

## Practice & Reflection Questions

1. **Explain** why a robot arm holding a heavy object needs integral (I) control, not just proportional (P).

2. **Describe** what happens to a PID-controlled robot if you suddenly double the Kd gain. Why?

3. **Analyze** a control problem: A robot is supposed to maintain a constant temperature in a heated chamber. The temperature overshoots the setpoint and oscillates. What PID tuning change would help?

4. **Design** a control system for a robot that tracks a moving target using a camera. What would the error signal be? How would P, I, and D help?

5. **Reflect**: Why is it harder to control a robot arm with a long reach than a short reach? (Hint: think about delays and inertia.)
